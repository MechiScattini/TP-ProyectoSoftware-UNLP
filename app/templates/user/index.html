{% extends "layout.html" %}
{% block title %}Usuarios{% endblock %}
{% block head %}
  {{ super() }}
{% endblock %}
{% block content %}
  <h2 style="display: flex; justify-content: center; ">Usuarios</h2>
  <form style="display: flex; justify-content: center;" method="POST" action="{{ url_for('user_index') }}" target="_blank">
    <input type="search" name="q" placeholder="ingrese username" autofocus required>
    <input type="submit" value= "Buscar"> 
  </form>
  <div>
  <a href="{{ url_for('user_index') }}" class="link" method="GET">Todos</a>
  <a href="{{ url_for('user_bloqueados') }}" class="link" method="GET">Bloqueados</a>
  <a href="{{ url_for('user_no_bloqueados') }}" class="link"  method="GET">No bloqueados</a>
  
  </div>
  {%if users.items %}
  <div class="table-responsive">
    <table class="table table-sm table-borderless mb-0">
        <thead class="thead-dark">
            <tr>
                <th>#</th>
                <th>Email</th>
                <th>Username</th>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Accion</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users.items %}
            <tr>
                <th scope="row">{{ loop.index }}</th>
                <td>{{ user.email }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.first_name }}</td>
                <td>{{ user.last_name }}</td>
                <td><a href="{{ url_for('user_edit', user_id= user.id ) }}" method="POST" class="link"> Editar </a> <a href="{{ url_for('user_delete', user_id= user.id ) }}" method="POST" class="link" onclick="return confirm('Eliminar usuario de email {{user.email}}')"> Eliminar</a>  </li></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
  </div>

  <br>
  <p>
  <a  style=" justify-content: left;" href="{{ url_for('user_create') }}" class="link">Nuevo</a>
  <nav  style="display: flex; justify-content: center;" aria-label="Page navigation example">
    <ul class="pagination">
        {% if users.has_prev %}
          <li class="page-item"> <a class="page-link" href="{{ url_for('user_index', page=users.prev_num) }}">Anterior</a></li>
        {% else %}
          <li class="page-item"><a class="page-link btn disabled" href="#">Anterior</a></li>
        {% endif %}


        {% if users.has_next %}
          <li class="page-item"> <a class="page-link" href="{{ url_for('user_index', page=users.next_num) }}">Siguiente</a></li>
        {% else %}
          <li class="page-item"><a class="page-link btn disabled" href="#">Siguiente</a></li>
        {% endif %}

    </ul>
  </nav>
  </p>
  {% else %}
    <h3 style="display: flex; justify-content: center; ">No hay usuarios cargados</h3>
  {% endif %}
{% endblock %}
